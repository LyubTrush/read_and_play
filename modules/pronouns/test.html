<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–¢—Ä–µ–Ω–∞–∂–µ—Ä: –ü—Ä–∏—Ç—è–∂–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è</title>
    <style>
      /* games-common.css - –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä */

      /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        font-family: "Inter", sans-serif;
        background: linear-gradient(135deg, #c2e1db, #e8f4f1);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
      }

      /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–≥—Ä—ã */
      .game-container {
        width: 100%;
        max-width: 900px;
        background: white;
        border-radius: 25px;
        box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        position: relative;
      }

      /* –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω—è */
      .level-select-screen {
        padding: 40px;
        text-align: center;
      }

      .game-title {
        font-size: 36px;
        font-weight: 700;
        color: #e57140;
        margin-bottom: 10px;
      }

      .game-subtitle {
        font-size: 18px;
        color: #666;
        margin-bottom: 40px;
      }

      .levels-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 40px;
      }

      .level-card {
        background: #f7f1e5;
        border-radius: 20px;
        padding: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 3px solid transparent;
      }

      .level-card:hover {
        transform: translateY(-5px);
        border-color: #e57140;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      }

      .level-card.completed {
        border-color: #4caf50;
        background: #f0f9f0;
      }

      .level-card.locked {
        opacity: 0.6;
        cursor: not-allowed;
        position: relative;
      }

      .level-card.locked::after {
        content: "üîí";
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 20px;
      }

      .level-number {
        font-size: 24px;
        font-weight: 700;
        color: #e57140;
        margin-bottom: 10px;
      }

      .level-name {
        font-size: 18px;
        font-weight: 600;
        color: #3f413e;
        margin-bottom: 15px;
      }

      .level-words {
        font-size: 14px;
        color: #666;
        line-height: 1.4;
      }

      .level-status {
        margin-top: 10px;
        font-size: 14px;
        font-weight: 600;
        color: #4caf50;
      }

      /* –ö–Ω–æ–ø–∫–∏ */
      .back-button {
        background: #aed7d1;
        color: white;
        border: none;
        border-radius: 25px;
        padding: 12px 30px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .back-button:hover {
        background: #9bc7c0;
        transform: translateY(-2px);
      }

      .menu-button-bottom {
        background: #aed7d1;
        color: white;
        border: none;
        border-radius: 25px;
        padding: 14px 35px;
        font-size: 16px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .menu-button-bottom:hover {
        background: #9bc7c0;
        transform: translateY(-2px);
      }

      /* –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω */
      .game-screen {
        display: none;
        padding: 30px;
        text-align: center;
      }

      .game-header {
        margin-bottom: 25px;
        position: relative;
      }

      /* –ö–Ω–æ–ø–∫–∞ –∑–≤—É–∫–∞ */
      .sound-toggle {
        position: absolute;
        top: 0;
        right: 0;
        background: #f7f1e5;
        border: none;
        border-radius: 20px;
        padding: 8px 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 14px;
        font-weight: 600;
        color: #3f413e;
      }

      .sound-toggle:hover {
        background: #e57140;
        color: white;
      }

      .sound-toggle img {
        width: 20px;
        height: 20px;
      }

      /* –ü—É—Ç–∏ –∫ –∏–∫–æ–Ω–∫–∞–º –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
      .sound-toggle img {
        content: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%233F413E"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/></svg>');
      }

      .sound-toggle.sound-off img {
        content: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%233F413E"><path d="M3.63 3.63a.996.996 0 000 1.41L7.29 9H3c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1h4l3.29 3.29c.63.63 1.71.18 1.71-.71v-4.17l4.18 4.18c-.49.37-1.02.68-1.6.91-.36.15-.58.53-.58.92 0 .72.73 1.18 1.39.91.8-.33 1.55-.77 2.22-1.31l1.34 1.34a.996.996 0 101.41-1.41L5.05 3.63c-.39-.39-1.02-.39-1.42 0zM19 12c0 .82-.15 1.61-.41 2.34l1.53 1.53c.56-1.17.88-2.48.88-3.87 0-3.83-2.4-7.11-5.78-8.4-.59-.23-1.22.23-1.22.86v.19c0 .38.25.71.61.85C17.18 6.54 19 9.06 19 12zm-8.71-6.29l-.17.17L12 7.76V6.41c0-.89-1.08-1.33-1.71-.7zM16.5 12A4.5 4.5 0 0014 7.97v1.79l2.48 2.48c.01-.08.02-.16.02-.24z"/></svg>');
      }

      /* –ö–Ω–æ–ø–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∑–≤—É–∫–∞ */
      .sound-button {
        background: #f7f1e5;
        border: none;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 10px rgba(197, 193, 192, 0.3);
        padding: 0;
      }

      .sound-button:hover {
        background: #c2e1db;
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(180, 178, 177, 0.4);
      }

      .sound-button:active {
        transform: scale(0.95);
      }

      .sound-button img {
        width: 30px;
        height: 30px;
        content: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%233F413E"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>');
      }

      /* –≠–ª–µ–º–µ–Ω—Ç—ã –∏–≥—Ä—ã */

      .sound-ar {
        color: #e74c3c;
        font-weight: bold;
        text-shadow: 0 0 10px rgba(231, 76, 60, 0.3);
      }
      .sound-e {
        color: #e57140;
        font-weight: bold;
        text-shadow: 0 0 10px rgba(231, 76, 60, 0.3);
      }

      .instruction {
        font-size: 22px;
        font-weight: 700;
        color: #e57140;
        margin-bottom: 20px;
        padding: 12px 25px;
        background: #fff5f0;
        border-radius: 20px;
        display: inline-block;
      }

      .level-info {
        font-size: 18px;
        color: #666;
        margin-bottom: 15px;
        font-weight: 600;
      }

      /* –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä */
      .progress-container {
        margin-bottom: 25px;
        padding: 0 10px;
      }

      .progress-dots {
        display: flex;
        justify-content: center;
        gap: 6px;
        flex-wrap: wrap;
        margin: 0 auto;
        max-width: 600px;
      }

      .progress-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: #f7f1e5;
        border: 2px solid #d3c9b5;
        transition: all 0.3s ease;
      }

      .progress-dot.correct {
        background: #4caf50;
        border-color: #4caf50;
        transform: scale(1.1);
      }

      .progress-dot.wrong {
        background: #ff6b6b;
        border-color: #ff6b6b;
        transform: scale(1.1);
      }

      .progress-dot.current {
        border-color: #e57140;
        background: #e57140;
        animation: pulse 1.5s infinite;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.2);
        }
        100% {
          transform: scale(1);
        }
      }

      /* –û–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
      .result-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        align-items: center;
        justify-content: center;
      }

      .result-modal {
        background: white;
        border-radius: 25px;
        padding: 40px;
        text-align: center;
        max-width: 500px;
        width: 90%;
        position: relative;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
      }

      .close-button {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #666;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .close-button:hover {
        background: #f7f1e5;
      }

      .result-image {
        width: 120px;
        height: 120px;
        margin: 0 auto 20px;
        border-radius: 20px;
        overflow: hidden;
      }

      .result-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .result-title {
        font-size: 32px;
        font-weight: 700;
        color: #3f413e;
        margin-bottom: 15px;
      }

      .result-stats {
        font-size: 20px;
        color: #666;
        margin-bottom: 30px;
        font-weight: 600;
      }

      .result-buttons {
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
      }

      .result-btn {
        padding: 12px 25px;
        border: none;
        border-radius: 20px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn-retry {
        background: #aed7d1;
        color: white;
      }

      .btn-next {
        background: #e57140;
        color: white;
      }

      .btn-menu {
        background: #aed7d1;
        color: white;
      }

      .btn-retry:hover,
      .btn-next:hover,
      .btn-menu:hover {
        transform: translateY(-2px);
      }

      /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .result-modal {
        animation: fadeIn 0.3s ease;
      }

      /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
      @media (max-width: 768px) {
        .game-container {
          margin: 10px;
        }

        .level-select-screen,
        .game-screen {
          padding: 25px 20px;
        }

        .game-title {
          font-size: 28px;
        }

        .game-subtitle {
          font-size: 16px;
        }

        .instruction {
          font-size: 18px;
          padding: 10px 20px;
        }

        .levels-grid {
          grid-template-columns: 1fr;
        }

        .result-modal {
          padding: 30px 25px;
        }

        .progress-dot {
          width: 10px;
          height: 10px;
        }
      }

      /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–≥—Ä—ã —Å –ø—Ä–∏—Ç—è–∂–∞—Ç–µ–ª—å–Ω—ã–º–∏ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è–º–∏ */
      .question-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 20px;
        margin: 20px 0;
      }

      .image-container {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 15px;
      }

      .question-image {
        width: 200px;
        height: 200px;
        display: flex;
        justify-content: center;
        align-items: center;
        background: #f8f9fa;
        border-radius: 16px;
        border: 3px solid #e9ecef;
        overflow: hidden;
      }

      .question-image img {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
      }

      .question-text {
        font-size: 24px;
        font-weight: 600;
        color: #3f413e;
        margin: 15px 0;
        min-height: 40px;
        line-height: 1.4;
      }

      .pronoun-gap {
        display: inline-block;
        min-width: 80px;
        border-bottom: 3px dashed #e57140;
        padding: 0 5px;
        margin: 0 5px;
        color: #e57140;
        font-weight: 700;
        text-align: center;
      }

      .pronoun-gap.filled {
        border-bottom: 3px solid #e57140;
        background-color: #fff5f0;
        border-radius: 5px;
      }

      .options-container {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .option {
        background: white;
        border: 3px solid #e9ecef;
        border-radius: 12px;
        padding: 15px 25px;
        font-size: 18px;
        font-weight: 600;
        color: #2d3748;
        cursor: pointer;
        transition: all 0.3s ease;
        min-width: 100px;
        text-align: center;
      }

      .option:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        border-color: #4299e1;
      }

      .option.selected {
        background: #e57140;
        color: white;
        border-color: #e57140;
      }

      .option.correct {
        background: #c6f6d5;
        border-color: #48bb78;
        color: #22543d;
      }

      .option.wrong {
        background: #fed7d7;
        border-color: #f56565;
        color: #742a2a;
      }

      .next-button {
        background: #e57140;
        color: white;
        border: none;
        border-radius: 25px;
        padding: 14px 35px;
        font-size: 16px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 20px;
      }

      .next-button:hover:not(:disabled) {
        background: #d16236;
        transform: translateY(-2px);
      }

      .next-button:disabled {
        background: #cccccc;
        cursor: not-allowed;
      }

      @media (max-width: 480px) {
        .question-image {
          width: 150px;
          height: 150px;
        }

        .question-text {
          font-size: 18px;
        }

        .options-container {
          gap: 10px;
        }

        .option {
          padding: 12px 20px;
          font-size: 16px;
          min-width: 80px;
        }

        .next-button {
          padding: 12px 25px;
          font-size: 14px;
        }
      }
    </style>
  </head>
  <body>
    <div class="game-container">
      <!-- –≠–∫—Ä–∞–Ω –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω—è -->
      <div class="level-select-screen" id="levelSelectScreen">
        <h1 class="game-title">–ü—Ä–∏—Ç—è–∂–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è</h1>
        <p class="game-subtitle">
          –í—ã–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        </p>

        <div class="levels-grid">
          <div class="level-card" data-level="1" id="levelCard1">
            <div class="level-number">–£—Ä–æ–≤–µ–Ω—å 1</div>
            <div class="level-name">–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è</div>
            <div class="level-words">my, your, his, her, our, their</div>
            <div class="level-status" id="levelStatus1"></div>
          </div>
          <div class="level-card" data-level="2" id="levelCard2">
            <div class="level-number">–£—Ä–æ–≤–µ–Ω—å 2</div>
            <div class="level-name">–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏–∑—É—á–∞—Ç—å</div>
            <div class="level-words">my, your, his, her, our, their</div>
            <div class="level-status" id="levelStatus2"></div>
          </div>
          <div class="level-card" data-level="3" id="levelCard3">
            <div class="level-number">–£—Ä–æ–≤–µ–Ω—å 3</div>
            <div class="level-name">–°–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</div>
            <div class="level-words">its, your, —Å–ª–æ–∂–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç</div>
            <div class="level-status" id="levelStatus3"></div>
          </div>
        </div>

        <button class="back-button" onclick="window.history.back()">
          –ù–∞–∑–∞–¥
        </button>
      </div>

      <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
      <div class="game-screen" id="gameScreen">
        <div class="game-header">
          <button class="sound-toggle" id="soundToggle">
            <img src="" alt="–ó–≤—É–∫" />
            <span>–ó–≤—É–∫</span>
          </button>
        </div>

        <div class="instruction">–ó–ê–ü–û–õ–ù–ò –ü–†–û–ü–£–°–ö</div>
        <div class="level-info" id="levelInfo">
          –£—Ä–æ–≤–µ–Ω—å 1: –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è
        </div>

        <div class="progress-container">
          <div class="progress-dots" id="progressDots"></div>
        </div>

        <div class="question-container">
          <div class="image-container">
            <div class="question-image">
              <img id="questionImage" src="" alt="Question Image" />
            </div>
          </div>

          <div class="question-text" id="questionText"></div>

          <div class="options-container" id="optionsContainer"></div>

          <button class="next-button" id="nextButton" disabled>–î–∞–ª–µ–µ</button>
        </div>
      </div>
    </div>

    <!-- –û–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
    <div class="result-overlay" id="resultOverlay">
      <div class="result-modal">
        <button class="close-button" id="closeResult">&times;</button>
        <div class="result-image">
          <img id="resultImage" src="" alt="–†–µ–∑—É–ª—å—Ç–∞—Ç" />
        </div>
        <h2 class="result-title" id="resultTitle">–û—Ç–ª–∏—á–Ω–æ!</h2>
        <div class="result-stats" id="resultStats">
          5 –∏–∑ 5 –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
        </div>
        <div class="result-buttons">
          <button class="result-btn btn-retry" id="retryButton">
            –ü–æ–≤—Ç–æ—Ä–∏—Ç—å
          </button>
          <button
            class="result-btn btn-next"
            id="nextLevelButton"
            style="display: none"
          >
            –°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å
          </button>
          <button class="result-btn btn-menu" id="menuButton">–í –º–µ–Ω—é</button>
        </div>
      </div>
    </div>

    <script>
      // –î–∞–Ω–Ω—ã–µ –¥–ª—è –∏–≥—Ä—ã
      const gameData = {
        levels: [
          {
            id: 1,
            name: "–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è",
            questions: [
              {
                image: "/assets/images/test/bob-bike.png",
                sentence: "This is Bob. This is ... bike.",
                options: ["my", "his", "her"],
                correctAnswer: "his",
              },
              {
                image: "/assets/images/test/kate-doll.png",
                sentence: "I am Kate. This is ... doll.",
                options: ["my", "his", "your"],
                correctAnswer: "my",
              },
              {
                image: "/assets/images/test/friends-house.png",
                sentence: "We are friends. This is ... house.",
                options: ["our", "their", "my"],
                correctAnswer: "our",
              },
              {
                image: "/assets/images/test/sisters-cat.png",
                sentence: "They are sisters. That is ... cat.",
                options: ["her", "our", "their"],
                correctAnswer: "their",
              },
              {
                image: "/assets/images/test/tom-book.png",
                sentence: "He is Tom. This is ... book.",
                options: ["his", "her", "their"],
                correctAnswer: "his",
              },
            ],
          },
          {
            id: 2,
            name: "–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –∏–∑—É—á–∞—Ç—å",
            questions: [
              {
                image: "/assets/images/test/red-backpack.png",
                sentence: "I have a red backpack. This is ... backpack.",
                options: ["my", "your", "her"],
                correctAnswer: "my",
              },
              {
                image: "/assets/images/test/new-ball.png",
                sentence: "He has a new ball. This is ... ball.",
                options: ["his", "her", "my"],
                correctAnswer: "his",
              },
              {
                image: "/assets/images/test/crayons.png",
                sentence: "We love to draw. These are ... crayons.",
                options: ["their", "our", "your"],
                correctAnswer: "our",
              },
              {
                image: "/assets/images/test/cute-rabbit.png",
                sentence: "She has a cute rabbit. This is ... rabbit.",
                options: ["his", "her", "my"],
                correctAnswer: "her",
              },
              {
                image: "/assets/images/test/game.png",
                sentence: "They are playing. This is ... game.",
                options: ["our", "their", "my"],
                correctAnswer: "their",
              },
            ],
          },
          {
            id: 3,
            name: "–°–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è",
            questions: [
              {
                image: "/assets/images/test/siblings-house.png",
                sentence:
                  "Tom and Anna are siblings. This is ... parents' house.",
                options: ["their", "our", "her"],
                correctAnswer: "their",
              },
              {
                image: "/assets/images/test/tim-book.png",
                sentence:
                  '"That is not my book. I think it is ...," said Tim, pointing to his brother.',
                options: ["my", "his", "her"],
                correctAnswer: "his",
              },
              {
                image: "/assets/images/test/tree-leaves.png",
                sentence:
                  "Look at that tree! All of ... leaves are brown and yellow.",
                options: ["their", "our", "its"],
                correctAnswer: "its",
              },
              {
                image: "/assets/images/test/city-friends.png",
                sentence:
                  "We live in this city. All of ... friends live here too.",
                options: ["their", "our", "your"],
                correctAnswer: "our",
              },
              {
                image: "/assets/images/test/classmate-pencil.png",
                sentence: '"Is this ... pencil?" I asked my classmate.',
                options: ["my", "your", "our"],
                correctAnswer: "your",
              },
            ],
          },
        ],
      };

      // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
      const levelSelectScreen = document.getElementById("levelSelectScreen");
      const gameScreen = document.getElementById("gameScreen");
      const levelInfo = document.getElementById("levelInfo");
      const progressDots = document.getElementById("progressDots");
      const questionImage = document.getElementById("questionImage");
      const questionText = document.getElementById("questionText");
      const optionsContainer = document.getElementById("optionsContainer");
      const nextButton = document.getElementById("nextButton");
      const resultOverlay = document.getElementById("resultOverlay");
      const resultTitle = document.getElementById("resultTitle");
      const resultStats = document.getElementById("resultStats");
      const resultImage = document.getElementById("resultImage");
      const retryButton = document.getElementById("retryButton");
      const nextLevelButton = document.getElementById("nextLevelButton");
      const menuButton = document.getElementById("menuButton");
      const closeResult = document.getElementById("closeResult");
      const soundToggle = document.getElementById("soundToggle");
      const levelCard1 = document.getElementById("levelCard1");
      const levelCard2 = document.getElementById("levelCard2");
      const levelCard3 = document.getElementById("levelCard3");
      const levelStatus1 = document.getElementById("levelStatus1");
      const levelStatus2 = document.getElementById("levelStatus2");
      const levelStatus3 = document.getElementById("levelStatus3");

      // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã
      let currentLevel = null;
      let currentQuestionIndex = 0;
      let score = 0;
      let selectedOption = null;
      let soundEnabled = true;
      let currentQuestion = null;
      let completedLevels =
        JSON.parse(localStorage.getItem("pronounsCompletedLevels")) || [];

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
      function initGame() {
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å—ã —É—Ä–æ–≤–Ω–µ–π
        updateLevelStatus();

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≤—ã–±–æ—Ä–∞ —É—Ä–æ–≤–Ω—è
        document.querySelectorAll(".level-card").forEach((card) => {
          card.addEventListener("click", () => {
            const levelId = parseInt(card.getAttribute("data-level"));
            if (canPlayLevel(levelId)) {
              startLevel(levelId);
            }
          });
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        nextButton.addEventListener("click", goToNextQuestion);
        retryButton.addEventListener("click", retryLevel);
        nextLevelButton.addEventListener("click", goToNextLevel);
        menuButton.addEventListener("click", goToMenu);
        closeResult.addEventListener("click", () => {
          resultOverlay.style.display = "none";
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∑–≤—É–∫–∞
        soundToggle.addEventListener("click", toggleSound);
      }

      // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –º–æ–∂–Ω–æ –ª–∏ –∏–≥—Ä–∞—Ç—å –≤ —É—Ä–æ–≤–µ–Ω—å
      function canPlayLevel(levelId) {
        if (levelId === 1) return true;
        return completedLevels.includes(levelId - 1);
      }

      // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã —É—Ä–æ–≤–Ω–µ–π
      function updateLevelStatus() {
        levelCard1.classList.toggle("completed", completedLevels.includes(1));
        levelCard2.classList.toggle("completed", completedLevels.includes(2));
        levelCard3.classList.toggle("completed", completedLevels.includes(3));

        // –ë–ª–æ–∫–∏—Ä—É–µ–º —É—Ä–æ–≤–Ω–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–ª—å–∑—è –ø—Ä–æ–π—Ç–∏
        levelCard2.classList.toggle("locked", !completedLevels.includes(1));
        levelCard3.classList.toggle("locked", !completedLevels.includes(2));

        levelStatus1.textContent = completedLevels.includes(1)
          ? "‚úì –ü—Ä–æ–π–¥–µ–Ω–æ"
          : "";
        levelStatus2.textContent = completedLevels.includes(2)
          ? "‚úì –ü—Ä–æ–π–¥–µ–Ω–æ"
          : "";
        levelStatus3.textContent = completedLevels.includes(3)
          ? "‚úì –ü—Ä–æ–π–¥–µ–Ω–æ"
          : "";
      }

      // –ù–∞—á–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å
      function startLevel(levelId) {
        currentLevel = gameData.levels.find((level) => level.id === levelId);
        if (!currentLevel) return;

        currentQuestionIndex = 0;
        score = 0;

        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Ä–æ–≤–Ω–µ
        levelInfo.textContent = `–£—Ä–æ–≤–µ–Ω—å ${levelId}: ${currentLevel.name}`;

        // –°–æ–∑–¥–∞–µ–º —Ç–æ—á–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        progressDots.innerHTML = "";
        for (let i = 0; i < currentLevel.questions.length; i++) {
          const dot = document.createElement("div");
          dot.className = "progress-dot";
          if (i === 0) dot.classList.add("current");
          progressDots.appendChild(dot);
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω
        levelSelectScreen.style.display = "none";
        gameScreen.style.display = "block";

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å
        loadQuestion(currentQuestionIndex);
      }

      // –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–æ–ø—Ä–æ—Å
      function loadQuestion(index) {
        if (index >= currentLevel.questions.length) {
          showResults();
          return;
        }

        currentQuestion = currentLevel.questions[index];
        selectedOption = null;
        nextButton.disabled = true;

        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        questionImage.src = currentQuestion.image;

        // –î–æ–±–∞–≤–ª—è–µ–º fallback –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        questionImage.onerror = function () {
          this.src =
            'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23666"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/></svg>';
        };

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞ —Å –ø—É—Å—Ç—ã–º –ø—Ä–æ–ø—É—Å–∫–æ–º
        updateQuestionText();

        // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
        optionsContainer.innerHTML = "";
        currentQuestion.options.forEach((option) => {
          const optionElement = document.createElement("div");
          optionElement.className = "option";
          optionElement.textContent = option;
          optionElement.addEventListener("click", () =>
            selectOption(optionElement, option)
          );
          optionsContainer.appendChild(optionElement);
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
        updateProgressDots(index);
      }

      // –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º –≤ –ø—Ä–æ–ø—É—Å–∫–µ
      function updateQuestionText(selectedAnswer = null) {
        if (selectedAnswer) {
          const sentenceWithAnswer = currentQuestion.sentence.replace(
            "...",
            `<span class="pronoun-gap filled">${selectedAnswer}</span>`
          );
          questionText.innerHTML = sentenceWithAnswer;
        } else {
          const sentenceWithGap = currentQuestion.sentence.replace(
            "...",
            '<span class="pronoun-gap">_____</span>'
          );
          questionText.innerHTML = sentenceWithGap;
        }
      }

      // –í—ã–±—Ä–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞
      function selectOption(optionElement, selectedAnswer) {
        if (selectedOption !== null) return; // –£–∂–µ –≤—ã–±—Ä–∞–Ω –æ—Ç–≤–µ—Ç

        selectedOption = selectedAnswer;

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞ —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º
        updateQuestionText(selectedAnswer);

        // –ü–æ–º–µ—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
        optionElement.classList.add("selected");

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç–≤–µ—Ç
        const isCorrect = selectedAnswer === currentQuestion.correctAnswer;

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
        document.querySelectorAll(".option").forEach((opt) => {
          if (opt.textContent === currentQuestion.correctAnswer) {
            opt.classList.add("correct");
          } else if (opt.textContent === selectedAnswer && !isCorrect) {
            opt.classList.add("wrong");
          }

          // –û—Ç–∫–ª—é—á–∞–µ–º –¥–∞–ª—å–Ω–µ–π—à–∏–µ –∫–ª–∏–∫–∏
          opt.style.pointerEvents = "none";
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç
        if (isCorrect) {
          score++;
          updateProgressDots(currentQuestionIndex, true);
        } else {
          updateProgressDots(currentQuestionIndex, false);
        }

        // –í–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É "–î–∞–ª–µ–µ"
        nextButton.disabled = false;
      }

      // –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
      function goToNextQuestion() {
        currentQuestionIndex++;
        loadQuestion(currentQuestionIndex);
      }

      // –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ—á–∫–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
      function updateProgressDots(index, isCorrect = null) {
        const dots = document.querySelectorAll(".progress-dot");

        dots.forEach((dot, i) => {
          dot.classList.remove("current");

          if (i === index) {
            dot.classList.add("current");
          }

          if (isCorrect !== null && i === index) {
            if (isCorrect) {
              dot.classList.add("correct");
            } else {
              dot.classList.add("wrong");
            }
          }
        });
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
      function showResults() {
        const totalQuestions = currentLevel.questions.length;
        const percentage = (score / totalQuestions) * 100;

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
        if (percentage === 100) {
          resultTitle.textContent = "–û—Ç–ª–∏—á–Ω–æ!";
          resultImage.src = "/assets/images/test/result-success.png";
        } else if (percentage >= 70) {
          resultTitle.textContent = "–•–æ—Ä–æ—à–æ!";
          resultImage.src = "/assets/images/test/result-good.png";
        } else {
          resultTitle.textContent = "–ü–æ–ø—Ä–æ–±—É–π –µ—â–µ!";
          resultImage.src = "/assets/images/test/result-try-again.png";
        }

        // Fallback –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        resultImage.onerror = function () {
          if (percentage === 100) {
            this.src =
              'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%234CAF50"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>';
          } else if (percentage >= 70) {
            this.src =
              'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23FF9800"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>';
          } else {
            this.src =
              'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23F44336"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>';
          }
        };

        resultStats.textContent = `${score} –∏–∑ ${totalQuestions} –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤`;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å
        const nextLevelId = currentLevel.id + 1;
        const hasNextLevel = gameData.levels.some(
          (level) => level.id === nextLevelId
        );

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å" –µ—Å–ª–∏ –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ö–æ—Ä–æ—à–∏–π
        if (hasNextLevel && percentage >= 70) {
          nextLevelButton.style.display = "block";
        } else {
          nextLevelButton.style.display = "none";
        }

        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
        if (!completedLevels.includes(currentLevel.id)) {
          completedLevels.push(currentLevel.id);
          localStorage.setItem(
            "pronounsCompletedLevels",
            JSON.stringify(completedLevels)
          );
          updateLevelStatus();
        }

        resultOverlay.style.display = "flex";
      }

      // –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–≤–Ω—é
      function goToNextLevel() {
        resultOverlay.style.display = "none";
        startLevel(currentLevel.id + 1);
      }

      // –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å
      function retryLevel() {
        resultOverlay.style.display = "none";
        startLevel(currentLevel.id);
      }

      // –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é
      function goToMenu() {
        resultOverlay.style.display = "none";
        gameScreen.style.display = "none";
        levelSelectScreen.style.display = "block";
      }

      // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫
      function toggleSound() {
        soundEnabled = !soundEnabled;
        soundToggle.classList.toggle("sound-off", !soundEnabled);
        soundToggle.querySelector("span").textContent = soundEnabled
          ? "–ó–≤—É–∫"
          : "–ë–µ–∑ –∑–≤—É–∫–∞";
      }

      // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      window.addEventListener("DOMContentLoaded", initGame);
    </script>
  </body>
</html>
